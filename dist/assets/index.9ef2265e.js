import{_ as e}from"./index.13a7003e.js";import a from"./index.d8a0cd4d.js";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang.e10eb450.js";import{u as l}from"./useMatch.67988d16.js";import{s,U as o,b as i,d as n,w as u,M as c,n as v,f as r,r as d,E as m,o as p,R as f,P as y,W as h,$ as g,q as I,_ as b,x as T,u as k,V as w,Y as x,Z as _,c as S,X as j,a as C,h as R,g as N,O as U,F as V,S as L}from"./vue.d6a430ba.js";import{v as M}from"./video.es.2d2a0771.js";import{s as B,T as $,U as H}from"./index.6c03c100.js";import{g as O}from"./getScore.9a46acdc.js";import{e as D,a as E}from"./index.d0cbedef.js";const F={key:0,class:"video-error"},q=(e=>(x("data-v-0ac99c3f"),e=e(),_(),e))((()=>y("span",{class:"video-icon"},null,-1))),z={class:"error-tips"},K={key:1,class:"touch-pop"},Y={class:"team-info"},A={class:"team-item"},P={type:4,style:{"object-fit":"contain"},alt:""},W={class:"team-name text-overflow"},X={class:"team-item"},Z={class:"team-name text-overflow"},G={type:5,style:{"object-fit":"contain"},alt:""},J={class:"team-score"},Q=["onClick"],ee=["onClick"];var ae=s({props:{liveInfo:{type:Object,default:()=>{}},liveUrl:{type:String,default:""},controls:{type:Boolean,default:!0}},emits:["refresh","touchVideo"],setup(e,{expose:a,emit:t}){const l=e,s=o(),x=i((()=>B.state.match.turnSound)),_=n(null),S=n(!1),j=n(!0),C=n(!1);u(x,((e,a)=>{console.log(`turnSound发生变化，新值为：${e}，旧值为：${a}`),e?(_.value.muted(!1),j.value=!1):(_.value.muted(!0),j.value=!0)}));const R=()=>{C.value=!C.value},N=()=>{if(!l.liveInfo)return;const{gidm:e}=l.liveInfo,a={name:"MatchDetail",params:{id:e}};s.push(a),B.dispatch("app/setMatchLiveIndex",1)},U=()=>{x.value?(j.value=!1,_.value.muted(!1)):(j.value=!0,_.value.muted(!0))},V=n(),L=()=>{try{_.value.dispose&&_.value.dispose()}catch(e){}},$=()=>{if(!document.querySelector("#VideoRef"))return!1;_.value.muted()?(_.value.muted(!1),j.value=!1,B.commit("match/SET_TURN_SOUND",!1)):(_.value.muted(!0),j.value=!0,B.commit("match/SET_TURN_SOUND",!0))},H=()=>{t("refresh")};a({refresh:H,touchVideo:()=>{t("touchVideo")}});const D=n(!0);return c((()=>{v((()=>{clearTimeout(V.value),V.value=setTimeout((()=>{S.value=!1;const e=document.querySelector("#VideoRef");if(e&&l.liveUrl)try{_.value=M("VideoRef",{muted:!0,controls:l.controls,width:"100%",height:"100%",loop:!0,autoplay:!0,sources:[{src:l.liveUrl,type:"application/x-mpegURL"}]},(()=>{try{e.muted=!0,e.play(),_.value.on("error",(()=>{S.value=!0,L()}))}catch(a){console.error(a)}}))}catch(a){console.error("视频异常！"),console.error(a)}}),500),setTimeout((()=>{D.value=!1}),2e3)}))})),r((()=>{L()})),(a,t)=>{const l=d("van-loading"),s=m("img");return p(),f("div",{class:"video-box-wrap",onClick:R},[y("video",{id:"VideoRef",style:{"object-fit":"fill"},class:"video-js vjs-default-skin",playsinline:"true",controls:"",preload:"metadata",onPlay:U},null,32),S.value?(p(),f("div",F,[q,y("div",z,h(a.$t("live.videoFailure")),1),y("div",{class:"error-btn",onClick:H},h(a.$t("live.refreshVideo")),1)])):g("",!0),y("div",{class:b(["pop",{popBg:D.value}])},[I(l,{class:"popBg-loading"})],2),C.value?(p(),f("div",K,[y("div",Y,[y("div",A,[T(y("img",P,null,512),[[s,e.liveInfo.homeLogo]]),y("span",W,h(e.liveInfo.homeTeamAbbr||e.liveInfo.homeTeam),1)]),y("div",X,[y("span",Z,h(e.liveInfo.awayTeamAbbr||e.liveInfo.awayTeam),1),T(y("img",G,null,512),[[s,e.liveInfo.awayLogo]])])]),y("div",J,h(k(O)(e.liveInfo,"H"))+" : "+h(k(O)(e.liveInfo,"C")),1),y("div",{class:"match-btn",onClick:w(N,["stop"])},h(a.$t("live.goLive")),9,Q)])):g("",!0),y("div",{class:b(["sound-icon",{muted:j.value}]),onClick:w($,["stop"])},null,10,ee)])}}});ae.__scopeId="data-v-0ac99c3f";const te={class:"video-footer"},le={class:"leagueName text-overflow"},se=(e=>(x("data-v-35548c98"),e=e(),_(),e))((()=>y("div",{class:"flex-1"},null,-1))),oe=["innerHTML"];var ie=s({props:{liveInfo:{type:Object,default:()=>{}},matchIndex:{type:Number,default:0},activeIndex:{type:Number,default:0}},setup(e){const a=e,t=l(),s=i((()=>"/assets/ft.7964dceb.jpg"));u((()=>a.activeIndex),(()=>{a.activeIndex===a.matchIndex?b():m.value=!1})),u((()=>a.liveInfo.gidm),(()=>{r()})),c((()=>{r()}));const o=n(""),r=async()=>{const e=a.liveInfo.gidm,t=await D({gidm:e});if(200===t.code){const{streamNa:e}=t.data,{liveali:l,live:s}=e||{},{m3u8:i}=l||s||{};o.value=a.liveInfo.m3u8||i}},m=n(!1),b=()=>{m.value=!1,v((()=>{m.value=!0}))};return c((()=>{a.activeIndex===a.matchIndex?b():m.value=!1})),(a,l)=>{const i=d("SportsIcon");return p(),f("div",{class:"match-item-wrap",style:j({backgroundImage:`url(${k(s)})`})},[m.value?(p(),S(ae,{key:0,"live-url":o.value||e.liveInfo.url,liveInfo:e.liveInfo,controls:!1,onRefresh:b},null,8,["live-url","liveInfo"])):g("",!0),y("div",te,[I(i,{class:"SportsIcon","icon-src":e.liveInfo.gameType},null,8,["icon-src"]),y("div",le,h(e.liveInfo.leagueShortName||e.liveInfo.leagueName),1),se,y("div",{class:"time",innerHTML:k(t).showRBTime(e.liveInfo)},null,8,oe)])],4)}}});ie.__scopeId="data-v-35548c98";const ne={key:0,class:"swipeLive"},ue={class:"wrap"};var ce=s({setup(e){const a=n(0),t=n([]),l=async()=>{const e=await E({page:1,pageSize:5,rbType:1});if(200===e.code){const a=e?.data?.list||[];t.value=a}},s=e=>{a.value=e},o=n();return C((()=>{clearInterval(o.value)})),R((()=>{clearInterval(o.value)})),N((()=>{clearInterval(o.value),console.log(1234),o.value=setInterval((()=>{l()}),15e3)})),c((()=>{t.value.length=0,l(),o.value=setInterval((()=>{l()}),1e4)})),(e,l)=>{const o=d("van-swipe-item"),i=d("van-swipe");return t.value.length?(p(),f("div",ne,[I(i,{class:"my-swipe","indicator-color":"white",onChange:s},{default:U((()=>[(p(!0),f(V,null,L(t.value,((e,t)=>(p(),S(o,{key:t},{default:U((()=>[y("div",ue,[(p(),S(ie,{key:e.gidm,"live-info":e,"match-index":t,"active-index":a.value},null,8,["live-info","match-index","active-index"]))])])),_:2},1024)))),128))])),_:1})])):g("",!0)}}});ce.__scopeId="data-v-9f3601b2";const ve={class:"tabs-cut"},re={class:"sportlive"};var de=s({setup(l){const s=i((()=>{const e=B.state.app.globalBarHeaderHeight||48;return e>60?48:e})),o=n(),v=n(!1),m=n(null),T=async(e=!0)=>{await C(),await O(e)},w=n(""),x=n(!0),_=n([""]),j=n([]),C=async()=>{const e=await $({})||{};if(200===e.code&&e.data){const a=e.data||[];j.value=a.filter((e=>!_.value.includes(e.gameType))),j.value=[{gameType:""},...j.value]}},M=n([]),O=async(e=!0)=>{const a={gameType:o.value||"",showtype:"RB",timeStage:0,dateStage:0,gameSort:1,isNovice:"Y",onlyFavorite:0,leagueIds:"",gameTypeSon:"",page:1,pageSize:200};e&&(v.value=!1);const t=await H(a)||{};if(e&&(v.value=!0),200===t.code&&t.data?.matchList?.baseData){const e=t.data?.matchList?.baseData||[];M.value=e.filter((e=>!_.value.includes(e.gameType)))}else M.value=[]},D=()=>{},E=e=>{M.value=[],o.value=e,O()};c((()=>{K(),v.value=!1,T()})),N((()=>{K()})),R((()=>{W()})),r((()=>{W(),B.dispatch("home/setKeyValue",{key:"RrefShow",value:!0}),B.dispatch("home/setKeyValue",{key:"OUrefShow",value:!0}),B.dispatch("home/setKeyValue",{key:"MrefShow",value:!0})}));const F=i((()=>B.state.app.businessConfig.pushSwitch));u(F,(()=>{K()}));const q=i((()=>B.state.user.scrollNumY));u((()=>q.value),(e=>{e>88&&(x.value=!1)}));const z=n(),K=()=>{clearTimeout(z),z.value=setTimeout((()=>{A()}),100)},Y=n(15e3),A=()=>{1==+F.value&&(Y.value=12e4),W(),P.value=setInterval((()=>{T(!1)}),Y.value)},P=n(),W=()=>{clearInterval(P.value)},X=n(""),Z=i((()=>B.state.home.refreshChangeTime));return u(Z,(e=>{e&&(clearTimeout(X.value),X.value=setTimeout((()=>{}),100))})),(l,i)=>{const n=d("SportsButton"),u=d("Loading"),c=d("van-sticky"),r=d("HomeEmpty"),T=d("FooterHeight"),_=d("van-tab"),C=d("van-tabs");return p(),f("div",{ref_key:"newContainer",ref:m},[I(ce,{class:"mt10"}),y("div",ve,[I(C,{duration:.2,active:w.value,"onUpdate:active":i[0]||(i[0]=e=>w.value=e),shrink:"","line-height":"0",animated:x.value,onChange:E,"swipe-threshold":3,onClickTab:i[1]||(i[1]=e=>x.value=!0)},{default:U((()=>[(p(!0),f(V,null,L(j.value,((i,d)=>(p(),S(_,{key:d,name:i.gameType},{title:U((()=>[0===d?(p(),S(e,{key:0,text:l.$t("sport.all"),active:!o.value,class:"tabs-cut-1"},null,8,["text","active"])):(p(),S(n,{key:1,class:b(["tabs-cut-1",i.gameType]),text:i.gameType,active:w.value===i.gameType,count:i.count,"show-count":""},null,8,["text","active","class","count"]))])),default:U((()=>[y("div",re,[v.value?(p(),f(V,{key:1},[(p(!0),f(V,null,L(M.value,((e,l)=>(p(),f(V,{key:l},[0===l?(p(),S(c,{key:0,"offset-top":k(s),container:m.value,"z-index":"5"},{default:U((()=>[I(t,{class:b({mt20:0!==l}),"send-params":e},null,8,["class","send-params"])])),_:2},1032,["offset-top","container"])):g("",!0),I(a,{"play-title-toggle":!1,"send-params":e,tabType:"RB",class:b({mt10:0!==l})},null,8,["send-params","class"])],64)))),128)),M.value.length?g("",!0):(p(),S(r,{key:0}))],64)):(p(),S(u,{key:0})),M.value.length?(p(),f("div",{key:2,class:"Button-MatchMore mt10",onClick:D},[y("span",null,h(l.$t("live.noMore")),1)])):g("",!0),I(T)])])),_:2},1032,["name"])))),128))])),_:1},8,["duration","active","animated"])])],512)}}});de.__scopeId="data-v-68904684";export{de as default};
