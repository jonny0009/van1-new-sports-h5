import{w as a}from"./websocket.ddb2adf8.js";import{i as e,l as s}from"./index.f2334b61.js";import{u as t,s as n,X as o}from"./index.b9128a51.js";import{s as l,b as d,w as i,j as c,a as u,d as A,n as m,r as v,E as r,o as f,c as h,O as p,P,S as g,$ as w,q as b,B as O,V as y,F as U,_ as B,x,u as N,k as T,Z as E,X as z,Y as I}from"./vue.7833d4f2.js";const k=a=>(z("data-v-6a9ab0e4"),a=a(),I(),a),R={class:"chat-main"},X={class:"close"},D={key:0,class:"close-down"},S={key:1,class:"close-down"},V={class:"item"},C={class:"item-avatar"},j={class:"item-name"},J=k((()=>P("em",null,":",-1))),H={class:"item-cont"},K={class:"item-avatar"},L={type:3},W={class:"item-name"},F=k((()=>P("em",null,":",-1))),q={class:"item-cont"},Q={class:"chat-main__form"},Y=k((()=>P("button",{"native-type":"submit",hidden:""},null,-1))),Z={class:"action"};var M=l({props:{show:Boolean},emits:["update:show"],setup(l,{emit:z}){const I=l,{t:k}=t(),M=d({get:()=>I.show,set:a=>z("update:show",a)}),G=d((()=>n.state.app.showFixedBet)),_=d((()=>n.state.user.userInfo)),$=d((()=>n.state.match.matchInfo)),aa=d((()=>n.state.match.needTimer)),ea=d((()=>{const{isSend:a}=na.value;return!o()||1*a==0})),sa=d((()=>{const{isSend:a}=na.value;return 0==a||!ma.value})),ta=d((()=>{const{isSend:a,bettingTotal:e}=na.value;return o()?0==a?k("live.needBet",{num:e}):k("live.chatTip")+"...":k("live.needLogin")}));i((()=>$.value),(()=>{oa()})),c((()=>{})),u((()=>{var e;null==(e=a)||e.disconnect()}));const na=A({}),oa=async()=>{if(aa.value)return;const a={gidm:$.value.gidm,systemId:$.value.systemId,anchorId:void 0,version:"3.9.0"},s=await e(a);200===s.code&&(na.value=s.data||{},la(),da())},la=async()=>{const{roomNo:a,channelType:e}=na.value,t={roomNo:a,page:1,pageSize:20,channelType:e},n=await s(t),o=(n.extra||{}).messageList||[];if(200==n.code){const a=[];o.forEach((e=>{if(e.msgType&&2==+e.msgType&&e.content){(JSON.parse(e.content||"").bettingData||[]).forEach((e=>{a.push(e.gidm)}))}})),ca(o)}},da=async()=>{const{roomNo:e}=na.value,s=`/topic/1/${e}`;a.subscribe(s,(a=>{const e=JSON.parse(a.body);if(e&&1e3===e.action){const[a]=e.data;ca(a)}}))},ia=A([]),ca=a=>{a instanceof Array?ia.value=a.reverse().concat(ia.value):ia.value.push(a),Aa()},ua=A(null),Aa=()=>{const a=ua.value||{};m((()=>{a.scrollTop=a&&a.scrollHeight}))},ma=A(),va=()=>{const e=ma.value,{roomNo:s}=na.value,{playerId:t,teamId:n}=_.value,o={token:"1",msgType:"1",roomNo:s,content:e,playerId:t,teamId:n};a.send("/chat/sendMsg",JSON.stringify(o)),ma.value=""},ra=A(1),fa=a=>{ra.value=a};return(a,e)=>{const s=v("SvgIcon"),t=v("van-field"),n=v("van-form"),o=v("van-button"),l=v("van-popup"),d=r("img");return f(),h(l,{show:N(M),"onUpdate:show":e[4]||(e[4]=a=>T(M)?M.value=a:null),class:E(["chat",{"has-bet":N(G),fh:2===ra.value}]),position:"bottom",overlay:!1,"close-on-click-overlay":!0,round:""},{default:p((()=>[P("div",R,[P("div",X,[P("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqBAMAAAA37dRoAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAVUExURUdwTIilupG2toimu4emu4mmu4imuwt0PKkAAAAGdFJOUwC2BuCEe+WQgKIAAACuSURBVCjPdZMxDsIwDEWtAgcgQ2fKCRhgR+oFkDgBy7//EWjSNtjWI0ti68mO7W8zPu/7JdjD/DA7SSV4J+llB+nj4WGUbtUb4AVdvEcFuKJ6rlcJaIUmD3cmwD/EwY5wTx+tv0OwboTEu5U+uZkR3eDrmIpv8DmhKyzlpjY4oztc0pwanNE/XozA2fBnXAVWzN3BTnLXcUI8TZw8qwQVxepjpbKqeQN4W3iz8HwBt7ZwXfhVzLIAAAAASUVORK5CYII=",onClick:e[0]||(e[0]=a=>M.value=!1)})]),1===ra.value?(f(),g("div",D,[P("img",{src:"data:image/png;base64,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",onClick:e[1]||(e[1]=a=>fa(2))})])):w("",!0),2===ra.value?(f(),g("div",S,[P("img",{src:"/assets/down_round.edea70a6.png",onClick:e[2]||(e[2]=a=>fa(1))})])):w("",!0),P("div",{ref_key:"chatRef",ref:ua,class:"chat-main__wrapper"},[P("div",V,[P("div",C,[b(s,{name:"bot"})]),P("div",j,[O(y(a.$t("live.aiBot")),1),J]),P("div",H,y(a.$t("live.chatSys")),1)]),(f(!0),g(U,null,B(ia.value,(a=>(f(),g("div",{key:a.msgId,class:"item"},[P("div",K,[x(P("img",L,null,512),[[d,a.headImg]])]),P("div",W,[O(y(a.nickName),1),F]),P("div",q,y(a.content),1)])))),128))],512),P("div",Q,[b(n,{"submit-on-enter":"",onSubmit:va},{default:p((()=>[b(t,{modelValue:ma.value,"onUpdate:modelValue":e[3]||(e[3]=a=>ma.value=a),autocomplete:"off",placeholder:N(ta),disabled:N(ea),maxlength:50},null,8,["modelValue","placeholder","disabled"]),Y])),_:1}),P("div",Z,[b(o,{disabled:N(sa),onClick:va},{default:p((()=>[O(y(a.$t("live.send")),1)])),_:1},8,["disabled"])])])])])),_:1},8,["show","class"])}}});M.__scopeId="data-v-6a9ab0e4";export{M as default};
