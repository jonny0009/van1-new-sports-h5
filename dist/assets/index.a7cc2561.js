import{_ as e}from"./index.973c359b.js";import a from"./index.d131be4b.js";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang.50525dda.js";import{u as l}from"./useMatch.74f53305.js";import{s,b as o,d as i,w as n,M as u,n as v,f as c,r,E as d,o as m,R as p,P as f,W as y,$ as h,q as g,_ as I,x as b,u as T,V as w,Y as x,Z as k,c as _,X as S,a as j,h as C,g as R,O as N,F as V,S as U}from"./vue.97c0c246.js";import{v as L}from"./video.es.dbef9236.js";import{s as M,r as B,T as $,U as H}from"./index.58c15d6f.js";import{g as O}from"./getScore.fa91861a.js";import{e as D,a as E}from"./index.d9be88f6.js";const F={key:0,class:"video-error"},q=(e=>(x("data-v-1ac121af"),e=e(),k(),e))((()=>f("span",{class:"video-icon"},null,-1))),z={class:"error-tips"},K={key:1,class:"touch-pop"},Y={class:"team-info"},A={class:"team-item"},P={type:4,style:{"object-fit":"contain"},alt:""},W={class:"team-name text-overflow"},X={class:"team-item"},Z={class:"team-name text-overflow"},G={type:5,style:{"object-fit":"contain"},alt:""},J={class:"team-score"},Q=["onClick"];var ee=s({props:{liveInfo:{type:Object,default:()=>{}},liveUrl:{type:String,default:""},controls:{type:Boolean,default:!0}},emits:["refresh","touchVideo"],setup(e,{expose:a,emit:t}){const l=e,s=o((()=>M.state.match.turnSound)),x=i(null),k=i(!1),_=i(!0),S=i(!1);n(s,((e,a)=>{console.log(`turnSound发生变化，新值为：${e}，旧值为：${a}`),e?(x.value.muted(!1),_.value=!1):(x.value.muted(!0),_.value=!0)}));const j=()=>{S.value=!S.value},C=()=>{if(!l.liveInfo)return;const{gidm:e}=l.liveInfo,a={name:"MatchDetail",params:{id:e}};B.push(a),M.dispatch("app/setMatchLiveIndex",1)},R=()=>{s.value?(_.value=!1,x.value.muted(!1)):(_.value=!0,x.value.muted(!0))},N=i(),V=()=>{try{x.value.dispose&&x.value.dispose()}catch(e){}},U=()=>{if(!document.querySelector("#VideoRef"))return!1;x.value.muted()?(x.value.muted(!1),_.value=!1,M.commit("match/SET_TURN_SOUND",!1)):(x.value.muted(!0),_.value=!0,M.commit("match/SET_TURN_SOUND",!0))},$=()=>{t("refresh")};a({refresh:$,touchVideo:()=>{t("touchVideo")}});const H=i(!0);return u((()=>{v((()=>{clearTimeout(N.value),N.value=setTimeout((()=>{k.value=!1;const e=document.querySelector("#VideoRef");if(e&&l.liveUrl)try{x.value=L("VideoRef",{muted:!0,controls:l.controls,width:"100%",height:"100%",loop:!0,autoplay:!0,sources:[{src:l.liveUrl,type:"application/x-mpegURL"}]},(()=>{try{e.muted=!0,e.play(),x.value.on("error",(()=>{k.value=!0,V()}))}catch(a){console.error(a)}}))}catch(a){console.error("视频异常！"),console.error(a)}}),500),setTimeout((()=>{H.value=!1}),2e3)}))})),c((()=>{V()})),(a,t)=>{const l=r("van-loading"),s=d("img");return m(),p("div",{class:"video-box-wrap",onClick:j},[f("video",{id:"VideoRef",style:{"object-fit":"fill"},class:"video-js vjs-default-skin",playsinline:"true",controls:"",preload:"metadata",onPlay:R},null,32),k.value?(m(),p("div",F,[q,f("div",z,y(a.$t("live.videoFailure")),1),f("div",{class:"error-btn",onClick:$},y(a.$t("live.refreshVideo")),1)])):h("",!0),f("div",{class:I(["pop",{popBg:H.value}])},[g(l,{class:"popBg-loading"})],2),S.value?(m(),p("div",K,[f("div",Y,[f("div",A,[b(f("img",P,null,512),[[s,e.liveInfo.homeLogo]]),f("span",W,y(e.liveInfo.homeTeamAbbr||e.liveInfo.homeTeam),1)]),f("div",X,[f("span",Z,y(e.liveInfo.awayTeamAbbr||e.liveInfo.awayTeam),1),b(f("img",G,null,512),[[s,e.liveInfo.awayLogo]])])]),f("div",J,y(T(O)(e.liveInfo,"H"))+" : "+y(T(O)(e.liveInfo,"C")),1),f("div",{class:"match-btn",onClick:C},"前往直播厅")])):h("",!0),f("div",{class:I(["sound-icon",{muted:_.value}]),onClick:w(U,["stop"])},null,10,Q)])}}});ee.__scopeId="data-v-1ac121af";const ae={class:"video-footer"},te={class:"leagueName text-overflow"},le=(e=>(x("data-v-35548c98"),e=e(),k(),e))((()=>f("div",{class:"flex-1"},null,-1))),se=["innerHTML"];var oe=s({props:{liveInfo:{type:Object,default:()=>{}},matchIndex:{type:Number,default:0},activeIndex:{type:Number,default:0}},setup(e){const a=e,t=l(),s=o((()=>"/assets/ft.7964dceb.jpg"));n((()=>a.activeIndex),(()=>{a.activeIndex===a.matchIndex?b():I.value=!1})),n((()=>a.liveInfo.gidm),(()=>{d()})),u((()=>{d()}));const c=i(""),d=async()=>{const e=a.liveInfo.gidm,t=await D({gidm:e});if(200===t.code){const{streamNa:e}=t.data,{liveali:l,live:s}=e||{},{m3u8:o}=l||s||{};c.value=a.liveInfo.m3u8||o}},I=i(!1),b=()=>{I.value=!1,v((()=>{I.value=!0}))};return u((()=>{a.activeIndex===a.matchIndex?b():I.value=!1})),(a,l)=>{const o=r("SportsIcon");return m(),p("div",{class:"match-item-wrap",style:S({backgroundImage:`url(${T(s)})`})},[I.value?(m(),_(ee,{key:0,"live-url":c.value||e.liveInfo.url,liveInfo:e.liveInfo,controls:!1,onRefresh:b},null,8,["live-url","liveInfo"])):h("",!0),f("div",ae,[g(o,{class:"SportsIcon","icon-src":e.liveInfo.gameType},null,8,["icon-src"]),f("div",te,y(e.liveInfo.leagueShortName||e.liveInfo.leagueName),1),le,f("div",{class:"time",innerHTML:T(t).showRBTime(e.liveInfo)},null,8,se)])],4)}}});oe.__scopeId="data-v-35548c98";const ie={key:0,class:"swipeLive"},ne={class:"wrap"};var ue=s({setup(e){const a=i(0),t=i([]),l=async()=>{var e;const a=await E({page:1,pageSize:5,rbType:1});if(200===a.code){const l=(null==(e=null==a?void 0:a.data)?void 0:e.list)||[];t.value=l}},s=e=>{a.value=e},o=i();return j((()=>{clearInterval(o.value)})),C((()=>{clearInterval(o.value)})),R((()=>{clearInterval(o.value),console.log(1234),o.value=setInterval((()=>{l()}),15e3)})),u((()=>{t.value.length=0,l(),o.value=setInterval((()=>{l()}),1e4)})),(e,l)=>{const o=r("van-swipe-item"),i=r("van-swipe");return t.value.length?(m(),p("div",ie,[g(i,{class:"my-swipe","indicator-color":"white",onChange:s},{default:N((()=>[(m(!0),p(V,null,U(t.value,((e,t)=>(m(),_(o,{key:t},{default:N((()=>[f("div",ne,[(m(),_(oe,{key:e.gidm,"live-info":e,"match-index":t,"active-index":a.value},null,8,["live-info","match-index","active-index"]))])])),_:2},1024)))),128))])),_:1})])):h("",!0)}}});ue.__scopeId="data-v-9f3601b2";const ve={class:"tabs-cut"},ce={class:"sportlive"};var re=s({setup(l){const s=o((()=>{const e=M.state.app.globalBarHeaderHeight||48;return e>60?48:e})),v=i(),d=i(!1),b=i(null),w=async(e=!0)=>{await L(),await O(e)},x=i(""),k=i(!0),S=i([""]),j=i([]),L=async()=>{const e=await $({})||{};if(200===e.code&&e.data){const a=e.data||[];j.value=a.filter((e=>!S.value.includes(e.gameType))),j.value=[{gameType:""},...j.value]}},B=i([]),O=async(e=!0)=>{var a,t,l,s;const o={gameType:v.value||"",showtype:"RB",timeStage:0,dateStage:0,gameSort:1,isNovice:"Y",onlyFavorite:0,leagueIds:"",gameTypeSon:"",page:1,pageSize:200};e&&(d.value=!1);const i=await H(o)||{};if(e&&(d.value=!0),200===i.code&&(null==(t=null==(a=i.data)?void 0:a.matchList)?void 0:t.baseData)){const e=(null==(s=null==(l=i.data)?void 0:l.matchList)?void 0:s.baseData)||[];B.value=e.filter((e=>!S.value.includes(e.gameType)))}else B.value=[]},D=()=>{},E=e=>{B.value=[],v.value=e,O()};u((()=>{K(),d.value=!1,w()})),R((()=>{K()})),C((()=>{W()})),c((()=>{W(),M.dispatch("home/setKeyValue",{key:"RrefShow",value:!0}),M.dispatch("home/setKeyValue",{key:"OUrefShow",value:!0}),M.dispatch("home/setKeyValue",{key:"MrefShow",value:!0})}));const F=o((()=>M.state.app.businessConfig.pushSwitch));n(F,(()=>{K()}));const q=o((()=>M.state.user.scrollNumY));n((()=>q.value),(e=>{e>88&&(k.value=!1)}));const z=i(),K=()=>{clearTimeout(z),z.value=setTimeout((()=>{A()}),100)},Y=i(15e3),A=()=>{1==+F.value&&(Y.value=12e4),W(),P.value=setInterval((()=>{w(!1)}),Y.value)},P=i(),W=()=>{clearInterval(P.value)},X=i(""),Z=o((()=>M.state.home.refreshChangeTime));return n(Z,(e=>{e&&(clearTimeout(X.value),X.value=setTimeout((()=>{}),100))})),(l,o)=>{const i=r("SportsButton"),n=r("Loading"),u=r("van-sticky"),c=r("HomeEmpty"),w=r("FooterHeight"),S=r("van-tab"),C=r("van-tabs");return m(),p("div",{ref_key:"newContainer",ref:b},[g(ue,{class:"mt10"}),f("div",ve,[g(C,{duration:.2,active:x.value,"onUpdate:active":o[0]||(o[0]=e=>x.value=e),shrink:"","line-height":"0",animated:k.value,onChange:E,"swipe-threshold":3,onClickTab:o[1]||(o[1]=e=>k.value=!0)},{default:N((()=>[(m(!0),p(V,null,U(j.value,((o,r)=>(m(),_(S,{key:r,name:o.gameType},{title:N((()=>[0===r?(m(),_(e,{key:0,text:l.$t("sport.all"),active:!v.value,class:"tabs-cut-1"},null,8,["text","active"])):(m(),_(i,{key:1,class:I(["tabs-cut-1",o.gameType]),text:o.gameType,active:x.value===o.gameType,count:o.count,"show-count":""},null,8,["text","active","class","count"]))])),default:N((()=>[f("div",ce,[d.value?(m(),p(V,{key:1},[(m(!0),p(V,null,U(B.value,((e,l)=>(m(),p(V,{key:l},[0===l?(m(),_(u,{key:0,"offset-top":T(s),container:b.value,"z-index":"5"},{default:N((()=>[g(t,{class:I({mt20:0!==l}),"send-params":e},null,8,["class","send-params"])])),_:2},1032,["offset-top","container"])):h("",!0),g(a,{"play-title-toggle":!1,"send-params":e,tabType:"RB",class:I({mt10:0!==l})},null,8,["send-params","class"])],64)))),128)),B.value.length?h("",!0):(m(),_(c,{key:0}))],64)):(m(),_(n,{key:0})),B.value.length?(m(),p("div",{key:2,class:"Button-MatchMore mt10",onClick:D},[f("span",null,y(l.$t("live.noMore")),1)])):h("",!0),g(w)])])),_:2},1032,["name"])))),128))])),_:1},8,["duration","active","animated"])])],512)}}});re.__scopeId="data-v-68904684";export{re as default};
