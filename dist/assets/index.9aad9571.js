import{_ as e}from"./index.a9140cbf.js";import a from"./index.aa22f8e5.js";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang.f2edeca5.js";import{e as l,a as s}from"./index.ec2652fa.js";import{s as o,U as i,V as n,W as u}from"./index.d6b89f05.js";import{g as c,u as v}from"./useMatch.523518d5.js";import{s as r,U as d,b as m,d as p,w as f,M as h,n as y,f as g,r as I,E as w,o as T,R as b,P as k,$ as x,x as _,y as S,W as j,q as U,_ as C,u as N,V as R,Y as V,Z as L,c as B,X as M,O as $,F as H,S as O,g as D,h as F}from"./vue.16414fe4.js";import{v as W}from"./video.es.547ea753.js";const q={key:0,class:"video-iframe"},E=["src"],K={key:1,class:"video-error"},z=(e=>(V("data-v-1f6f4479"),e=e(),L(),e))((()=>k("span",{class:"video-icon"},null,-1))),P={class:"error-tips"},X={key:2,class:"touch-pop"},Y={class:"team-info"},A={class:"team-item"},J={type:4,style:{"object-fit":"contain"},alt:""},Z={class:"team-name text-overflow"},G={class:"team-item"},Q={class:"team-name text-overflow"},ee={type:5,style:{"object-fit":"contain"},alt:""},ae={class:"team-score"},te=["onClick"],le=["onClick"];var se=r({props:{liveInfo:{type:Object,default:()=>{}},liveUrl:{type:String,default:""},controls:{type:Boolean,default:!0}},emits:["refresh","touchVideo"],setup(e,{expose:a,emit:t}){const l=e,s=d(),i=m((()=>o.state.match.turnSound)),n=p(null),u=p(!1),v=p(!1),r=p(!1);f(i,((e,a)=>{console.log(`turnSound发生变化，新值为：${e}，旧值为：${a}`),e?(n.value.muted(!1),v.value=!1):(n.value.muted(!0),v.value=!0)}));const V=()=>{r.value=!r.value},L=()=>{if(!l.liveInfo)return;const{gidm:e}=l.liveInfo,a={};l.liveInfo.anchorId&&(a.anchorId=l.liveInfo.anchorId),l.liveInfo.m3u8&&(a.m3u8=l.liveInfo.m3u8);const t={name:"MatchDetail",params:{id:e},query:a};s.push(t),o.dispatch("app/setMatchLiveIndex",1)},B=()=>{i.value?(v.value=!1,n.value.muted(!1)):(v.value=!0,n.value.muted(!0))},M=p(),$=()=>{try{n.value.dispose&&n.value.dispose()}catch(e){}},H=()=>{if(!document.querySelector("#VideoRef"))return!1;n.value.muted()?(n.value.muted(!1),v.value=!1,o.commit("match/SET_TURN_SOUND",!1)):(n.value.muted(!0),v.value=!0,o.commit("match/SET_TURN_SOUND",!0))},O=()=>{t("refresh")};a({refresh:O,touchVideo:()=>{t("touchVideo")}});const D=p(!0);return h((()=>{y((()=>{clearTimeout(M.value),M.value=setTimeout((()=>{u.value=!1;const e=document.querySelector("#VideoRef");if(e&&l.liveUrl&&!l.liveUrl?.endsWith("html"))try{n.value=W("VideoRef",{muted:!1,controls:l.controls,width:"100%",height:"100%",loop:!0,autoplay:!0,sources:[{src:l.liveUrl,type:"application/x-mpegURL"}]},(()=>{try{e.muted=!1,e.play(),n.value.on("error",(()=>{u.value=!0,$()}))}catch(a){console.error(a)}}))}catch(a){console.error("视频异常！"),console.error(a)}}),500),setTimeout((()=>{D.value=!1}),2e3)}))})),g((()=>{$()})),(a,t)=>{const l=I("van-loading"),s=w("img");return T(),b("div",{class:"video-box-wrap",onClick:V},[e.liveUrl?.endsWith("html")?(T(),b("div",q,[k("iframe",{src:e.liveUrl,width:"100%",height:"100%",frameborder:"0"},null,8,E)])):x("",!0),_(k("video",{id:"VideoRef",style:{"object-fit":"fill"},class:"video-js vjs-default-skin",playsinline:"true",controls:"",preload:"metadata",onPlay:B},null,544),[[S,!e.liveUrl?.endsWith("html")]]),u.value?(T(),b("div",K,[z,k("div",P,j(a.$t("live.videoFailure")),1),k("div",{class:"error-btn",onClick:O},j(a.$t("live.refreshVideo")),1)])):x("",!0),k("div",{class:C(["pop",{popBg:D.value}])},[U(l,{class:"popBg-loading"})],2),r.value?(T(),b("div",X,[k("div",Y,[k("div",A,[_(k("img",J,null,512),[[s,e.liveInfo.homeLogo]]),k("span",Z,j(e.liveInfo.homeTeamAbbr||e.liveInfo.homeTeam),1)]),k("div",G,[k("span",Q,j(e.liveInfo.awayTeamAbbr||e.liveInfo.awayTeam),1),_(k("img",ee,null,512),[[s,e.liveInfo.awayLogo]])])]),k("div",ae,j(N(c)(e.liveInfo,"H"))+" : "+j(N(c)(e.liveInfo,"C")),1),k("div",{class:"match-btn",onClick:R(L,["stop"])},j(a.$t("live.goLive")),9,te)])):x("",!0),k("div",{class:C(["sound-icon",{muted:v.value}]),onClick:R(H,["stop"])},null,10,le)])}}});se.__scopeId="data-v-1f6f4479";const oe={class:"video-footer"},ie={class:"leagueName text-overflow"},ne=(e=>(V("data-v-c2e80794"),e=e(),L(),e))((()=>k("div",{class:"flex-1"},null,-1))),ue=["innerHTML"];var ce=r({props:{liveInfo:{type:Object,default:()=>{}},matchIndex:{type:Number,default:0},activeIndex:{type:Number,default:0}},setup(e){const a=e,t=v(),s=m((()=>"/assets/ft.7964dceb.jpg"));f((()=>a.activeIndex),(()=>{a.activeIndex===a.matchIndex?c():u.value=!1})),f((()=>a.liveInfo.gidm),(()=>{n()})),h((()=>{n()}));const o=p(""),n=async()=>{const e=a.liveInfo.gidm,t=await l({gidm:e});if(200===t.code){const{streamNaList:e}=t.data;console.log(e);const l=i(e);console.log(l,"====",a.liveInfo.m3u8),o.value=l||a.liveInfo.m3u8}},u=p(!1),c=()=>{u.value=!1,y((()=>{u.value=!0}))};return h((()=>{a.activeIndex===a.matchIndex?c():u.value=!1})),(a,l)=>{const i=I("SportsIcon");return T(),b("div",{class:"match-item-wrap",style:M({backgroundImage:`url(${N(s)})`})},[u.value?(T(),B(se,{key:0,"live-url":o.value||e.liveInfo.url,"live-info":e.liveInfo,controls:!1,onRefresh:c},null,8,["live-url","live-info"])):x("",!0),k("div",oe,[U(i,{class:"SportsIcon","icon-src":e.liveInfo.gameType},null,8,["icon-src"]),k("div",ie,j(e.liveInfo.leagueShortName||e.liveInfo.leagueName),1),ne,k("div",{class:"time",innerHTML:N(t).showRBTime(e.liveInfo)},null,8,ue)])],4)}}});ce.__scopeId="data-v-c2e80794";const ve={key:0,class:"swipeLive"},re={class:"wrap"};var de=r({setup(e){const a=p(0),t=p([]),l=e=>{a.value=e};return h((()=>{t.value.length=0,(async()=>{const e=await s({page:1,pageSize:5,rbType:1,filterFlag:2});if(200===e.code){const a=e?.data?.list||[];t.value.length=0,await a.map((async e=>{t.value.push(e)}))}})()})),(e,s)=>{const o=I("van-swipe-item"),i=I("van-swipe");return t.value.length?(T(),b("div",ve,[U(i,{class:"my-swipe","indicator-color":"white",onChange:l},{default:$((()=>[(T(!0),b(H,null,O(t.value,((e,t)=>(T(),B(o,{key:t},{default:$((()=>[k("div",re,[(T(),B(ce,{key:e.gidm,"live-info":e,"match-index":t,"active-index":a.value},null,8,["live-info","match-index","active-index"]))])])),_:2},1024)))),128))])),_:1})])):x("",!0)}}});de.__scopeId="data-v-2fad92d3";const me={class:"tabs-cut"},pe={class:"sportlive"};var fe=r({setup(l){const s=m((()=>{const e=o.state.app.globalBarHeaderHeight||48;return e>60?48:e})),i=p(),c=p(!1),v=p(null),r=async(e=!0)=>{await S(),await V(e)},d=p(""),y=p(!0),w=p([""]),_=p([]),S=async()=>{const e=await n({})||{};if(200===e.code&&e.data){const a=e.data.filter((e=>{if(!["OP_DJ","XNFT","XNBK"].includes(e.gameType))return e}));_.value=a.filter((e=>!w.value.includes(e.gameType))),_.value=[{gameType:""},..._.value]}},R=p([]),V=async(e=!0)=>{const a={gameType:i.value||"",showtype:"RB",timeStage:0,dateStage:0,gameSort:1,isNovice:"Y",onlyFavorite:0,leagueIds:"",gameTypeSon:"",page:1,pageSize:200};e&&(c.value=!1);const t=await u(a)||{};if(e&&(c.value=!0),200===t.code&&t.data?.matchList?.baseData){const e=t.data?.matchList?.baseData||[];R.value=e.filter((e=>!w.value.includes(e.gameType)))}else R.value=[]},L=()=>{},M=e=>{R.value=[],i.value=e,V()};h((()=>{K(),c.value=!1,r()})),D((()=>{K()})),F((()=>{Y()})),g((()=>{Y(),o.dispatch("home/setKeyValue",{key:"RrefShow",value:!0}),o.dispatch("home/setKeyValue",{key:"OUrefShow",value:!0}),o.dispatch("home/setKeyValue",{key:"MrefShow",value:!0})}));const W=m((()=>o.state.app.businessConfig.pushSwitch));f(W,(()=>{K()}));const q=m((()=>o.state.user.scrollNumY));f((()=>q.value),(e=>{e&&(y.value=!1)}));const E=p(),K=()=>{clearTimeout(E),E.value=setTimeout((()=>{P()}),100)},z=p(15e3),P=()=>{1==+W.value&&(z.value=12e4),Y(),X.value=setInterval((()=>{r(!1)}),z.value)},X=p(),Y=()=>{clearInterval(X.value)},A=p(""),J=m((()=>o.state.home.refreshChangeTime));return f(J,(e=>{e&&(clearTimeout(A.value),A.value=setTimeout((()=>{}),100))})),(l,o)=>{const n=I("SportsButton"),u=I("Loading"),r=I("van-sticky"),m=I("HomeEmpty"),p=I("FooterHeight"),f=I("van-tab"),h=I("van-tabs");return T(),b("div",{ref_key:"newContainer",ref:v},[U(de,{class:"mt10"}),k("div",me,[U(h,{active:d.value,"onUpdate:active":o[0]||(o[0]=e=>d.value=e),duration:.2,shrink:"","line-height":"0",animated:y.value,"swipe-threshold":3,onChange:M,onClickTab:o[1]||(o[1]=e=>y.value=!0)},{default:$((()=>[(T(!0),b(H,null,O(_.value,((o,h)=>(T(),B(f,{key:h,name:o.gameType},{title:$((()=>[0===h?(T(),B(e,{key:0,text:l.$t("sport.all"),active:!i.value,class:"tabs-cut-1"},null,8,["text","active"])):(T(),B(n,{key:1,class:C(["tabs-cut-1",o.gameType]),text:o.gameType,active:d.value===o.gameType,count:o.count,"show-count":""},null,8,["text","active","class","count"]))])),default:$((()=>[k("div",pe,[c.value?(T(),b(H,{key:1},[(T(!0),b(H,null,O(R.value,((e,l)=>(T(),b(H,{key:l},[0===l?(T(),B(r,{key:0,"offset-top":N(s),container:v.value,"z-index":"5"},{default:$((()=>[U(t,{class:C({mt20:0!==l}),"send-params":e},null,8,["class","send-params"])])),_:2},1032,["offset-top","container"])):x("",!0),U(a,{"play-title-toggle":!1,"send-params":e,"tab-type":"RB",class:C({mt10:0!==l})},null,8,["send-params","class"])],64)))),128)),R.value.length?x("",!0):(T(),B(m,{key:0}))],64)):(T(),B(u,{key:0})),R.value.length?(T(),b("div",{key:2,class:"Button-MatchMore mt10",onClick:L},[k("span",null,j(l.$t("live.noMore")),1)])):x("",!0),U(p)])])),_:2},1032,["name"])))),128))])),_:1},8,["active","duration","animated"])])],512)}}});fe.__scopeId="data-v-32211968";export{fe as default};
