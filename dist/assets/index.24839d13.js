import{u as e,O as a,s,r as t,h as l}from"./index.81ed1559.js";import{s as u,d as o,o as r,S as n,P as m,F as i,_ as v,Z as c,V as d,n as p,X as f,Y as g,b as T,w as h,e as D,M as Y,r as y,q as _,O as b,u as M,c as k,$ as S}from"./vue.7833d4f2.js";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang.bcbd9037.js";import{r as x}from"./index.571eb9c9.js";const w=["onClick"],C=[(e=>(f("data-v-540777cd"),e=e(),g(),e))((()=>m("i",{class:"iconfont icon-timeMore"},null,-1)))];var V=u({emits:["returnTimeSuccess","DateShow"],setup(s,{expose:t,emit:l}){const{t:u}=e(),f=o([{text:u("sport.all"),defaultToggle:!0,values:""},{text:u("home.numberHour",{number:"8"}),defaultToggle:!0,values:"8"},{text:u("home.numberHour",{number:"24"}),defaultToggle:!0,values:"24"},{text:u("home.numberDay",{number:"7"}),defaultToggle:!0,values:"168"}]),g=o(""),T=()=>{l("DateShow",!0)};t({active:g,onConfirm:e=>{const[s,t]=e,u=f.value.filter((e=>e.defaultToggle)),o=`${a(s).format("YYYY/MM/DD")} - ${a(t).format("YYYY/MM/DD")}`;f.value=[...u,{text:o,values:o}],g.value=o,l("returnTimeSuccess",g.value),p((()=>{h.value?.scrollTo(D.value?.clientWidth,0)}))}});const h=o(),D=o();return(e,a)=>(r(),n("div",{ref_key:"refHomeTime",ref:h,class:"homeTime-Time-Tabs pb10"},[m("div",{ref_key:"refHomeTimePage",ref:D,class:"homeTime-TimePage"},[(r(!0),n(i,null,v(f.value,((e,a)=>(r(),n("div",{key:a,class:c(["item",{active:e.values===g.value}]),onClick:a=>(e=>{g.value=e.values,l("returnTimeSuccess",g.value)})(e)},d(e.text),11,w)))),128)),m("div",{class:"more",onClick:T},C)],512)],512))}});V.__scopeId="data-v-540777cd";const j={class:"mt10"};var O=u({setup(e){const u=T((()=>s.state.user.scrollNumY)),d=T((()=>{const e=s.state.app.globalBarHeaderHeight||48;return e>60?48:e})),p=o(null),f=o(!1),g=T((()=>t?.currentRoute?.value?.name||"")),w=T((()=>s.state.home.refreshChangeTime)),C=o(""),O=o(),R=o();h((()=>u.value),(e=>{e>88&&(O.value.ifAnimated=!1)})),h(w,(e=>{e&&(O.value?.resetParams(),clearTimeout(C.value),C.value=setTimeout((async()=>{await Q(),await J()}),100))}));const F=o(!1),P=o(!1),$=D({page:1,pageSize:5,gradeType:2,gameType:"FT"});"sportToday"===g.value&&($.startDate=a().format("YYYY-MM-DD")+" 00:00:00",$.endDate=a().format("YYYY-MM-DD")+" 23:59:59");const z=o([]),A=o([]),N=o(0),U=(e=!1,a="")=>{a?L.value=!e:F.value=e},I=()=>{P.value=!1,s.dispatch("home/setRefreshChangeTime",(new Date).getTime())},J=async(e="")=>{U(!1,e);const a=await x($);if(U(!0,e),200===a.code){const s=a?.data||{},{baseData:t,total:u}=s;N.value=u;const{pageSize:o,page:r}=$;e?q.value=!(o*r<u):(z.value=[],A.value=[]),A.value.push(...t);const n={},m=[];A.value.sort(((e,a)=>e.gameDate-a.gameDate)).map((e=>{const a=l(e.gameDate).format("YYYY/MM/DD");n[a]?n[a].list.push(e):n[a]={gameDate:e.gameDate,list:[e]}})),Object.keys(n).map((e=>{m.push(JSON.parse(JSON.stringify(n[e])))})),z.value=m}},L=o(!1),q=o(!1),B=o(""),E=o(!1),W=()=>{E.value?q.value||L.value||(L.value=!0,clearTimeout(B.value),B.value=setTimeout((()=>{$.page++,J(!0)}),100)):E.value=!0},X=e=>{f.value=e},Z=e=>{f.value=!1,R.value.onConfirm(e)},G=e=>{if(e)if((e||"").includes("/")){const[a,s]=e.split("-"),t=a.replaceAll("/","-"),l=s.replaceAll("/","-");$.startDate=t+" 00:00:00",$.endDate=l+" 23:59:59"}else $.startDate=a().format("YYYY-MM-DD HH:mm:ss"),$.endDate=a().add(e,"hour").format("YYYY-MM-DD HH:mm:ss");else $.startDate="",$.endDate="";q.value=!1,$.page=1,J()},K=e=>{F.value=!0,$.gameType=e,q.value=!1,$.page=1,J()},Q=()=>{$.page=1,$.gameType="FT"};return Y((()=>{J()})),(e,a)=>{const s=y("van-sticky"),t=y("HomeMatchHandicap"),l=y("HomeEmpty"),u=y("Loading"),o=y("van-list"),T=y("SportsTabs"),h=y("van-pull-refresh"),D=y("FooterHeight"),Y=y("van-calendar");return r(),n("div",{class:"homeTime-page",ref_key:"newContainer",ref:p},[_(h,{modelValue:P.value,"onUpdate:modelValue":a[1]||(a[1]=e=>P.value=e),onRefresh:I},{default:b((()=>[_(T,{ref_key:"refSportsTabs",ref:O,class:"pb10",onReturnSportsSuccess:K},{body:b((()=>[m("div",j,["HomeTime"===M(g)?(r(),k(V,{key:0,ref_key:"refTimeTabs",ref:R,onReturnTimeSuccess:G,onDateShow:X},null,512)):S("",!0),_(o,{modelValue:L.value,"onUpdate:modelValue":a[0]||(a[0]=e=>L.value=e),finished:q.value,"finished-text":e.$t("live.noMore"),onLoad:W},{default:b((()=>[F.value?(r(),n(i,{key:0},[(r(!0),n(i,null,v(z.value,((e,a)=>(r(),n(i,{key:a},[_(s,{"offset-top":M(d),container:p.value,"z-index":"8",class:c({mt10:0!==a})},{default:b((()=>[_(H,{"send-params":e},null,8,["send-params"])])),_:2},1032,["offset-top","container","class"]),(r(!0),n(i,null,v(e.list,((e,a)=>(r(),k(t,{"play-title-toggle":!1,"send-params":e,class:c({mt10:0!==a})},null,8,["send-params","class"])))),256))],64)))),128)),z.value.length?S("",!0):(r(),k(l,{key:0}))],64)):S("",!0),!F.value||L.value?(r(),k(u,{key:1,class:c({"new_loading mt10":L.value})},null,8,["class"])):S("",!0)])),_:1},8,["modelValue","finished","finished-text"])])])),_:1},512)])),_:1},8,["modelValue"]),_(D),_(Y,{show:f.value,"onUpdate:show":a[2]||(a[2]=e=>f.value=e),type:"range",onConfirm:Z},null,8,["show"])],512)}}});O.__scopeId="data-v-a0e474ea";export{O as default};
