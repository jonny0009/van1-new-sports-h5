import{_ as e}from"./index.500596e3.js";import a from"./index.ae8bf2c4.js";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang.b4feeac0.js";import{u as s}from"./useMatch.0aed8cab.js";import{s as l,b as o,d as i,w as n,M as u,n as c,f as r,r as v,o as d,S as m,P as p,$ as f,x as h,y,V as g,q as b,Z as k,U as x,X as w,Y as T,c as _,u as I,W as S,O as j,F as U,_ as N,g as C,h as R}from"./vue.7833d4f2.js";import{v as V}from"./video.es.7afabe4f.js";import{s as M,a3 as B,r as L}from"./index.cb503d4e.js";import{a as $,e as H}from"./index.0aa3d0a3.js";import{f as D,i as O}from"./index.8c8eef35.js";import"./getScore.7cf056ba.js";const F={class:"video-box-wrap"},W={key:0,class:"video-iframe"},q=["src"],z={key:1,class:"video-error"},E=(e=>(w("data-v-21c0b17d"),e=e(),T(),e))((()=>p("span",{class:"video-icon"},null,-1))),K={class:"error-tips"},Y=["onClick"];var P=l({props:{liveUrl:{type:String,default:""},controls:{type:Boolean,default:!0}},emits:["refresh","touchVideo"],setup(e,{expose:a,emit:t}){const s=e,l=o((()=>M.state.match.turnSound)),w=i(null),T=i(!1),_=i(!0);n(l,((e,a)=>{console.log(`turnSound发生变化，新值为：${e}，旧值为：${a}`),e?(w.value.muted(!1),_.value=!1):(w.value.muted(!0),_.value=!0)}));const I=()=>{l.value?(_.value=!1,w.value.muted(!1)):(_.value=!0,w.value.muted(!0))},S=i(),j=()=>{try{w.value.dispose&&w.value.dispose()}catch(e){}},U=()=>{if(!document.querySelector("#VideoRef"))return!1;w.value.muted()?(w.value.muted(!1),_.value=!1,M.commit("match/SET_TURN_SOUND",!1)):(w.value.muted(!0),_.value=!0,M.commit("match/SET_TURN_SOUND",!0))},N=()=>{t("refresh")};a({refresh:N,touchVideo:()=>{t("touchVideo")}});const C=i(!0);return u((()=>{c((()=>{clearTimeout(S.value),S.value=setTimeout((()=>{T.value=!1;const e=document.querySelector("#VideoRef");if(e&&s.liveUrl&&!s.liveUrl?.endsWith("html"))try{w.value=V("VideoRef",{muted:!0,controls:s.controls,width:"100%",height:"100%",loop:!0,autoplay:!0,sources:[{src:s.liveUrl,type:"application/x-mpegURL"}]},(()=>{try{e.muted=!0,e.play(),w.value.on("error",(()=>{T.value=!0,j()}))}catch(a){console.error(a)}}))}catch(a){console.error("视频异常！"),console.error(a)}}),500),setTimeout((()=>{C.value=!1}),2e3)}))})),r((()=>{j()})),(a,t)=>{const s=v("van-loading");return d(),m("div",F,[e.liveUrl?.endsWith("html")?(d(),m("div",W,[p("iframe",{src:e.liveUrl,width:"100%",height:"100%",frameborder:"0"},null,8,q)])):f("",!0),h(p("video",{id:"VideoRef",style:{"object-fit":"fill"},class:"video-js vjs-default-skin",playsinline:"true",controls:"",preload:"metadata",onPlay:I},null,544),[[y,!e.liveUrl?.endsWith("html")]]),T.value?(d(),m("div",z,[E,p("div",K,g(a.$t("live.videoFailure")),1),p("div",{class:"error-btn",onClick:N},g(a.$t("live.refreshVideo")),1)])):f("",!0),p("div",{class:k(["pop",{popBg:C.value}])},[b(s,{class:"popBg-loading"})],2),p("div",{class:k(["sound-icon",{muted:_.value}]),onClick:x(U,["stop"])},null,10,Y)])}}});P.__scopeId="data-v-21c0b17d";const X={class:"video-footer"},Z={class:"leagueName text-overflow"},A=(e=>(w("data-v-6091e662"),e=e(),T(),e))((()=>p("div",{class:"flex-1"},null,-1))),G=["innerHTML"];var J=l({props:{liveInfo:{type:Object,default:()=>{}},matchIndex:{type:Number,default:0},activeIndex:{type:Number,default:0}},setup(e){const a=e,t=s(),l=o((()=>"/assets/ft.7964dceb.jpg"));n((()=>a.activeIndex),(()=>{a.activeIndex===a.matchIndex?h():r.value=!1}));const r=i(!1),h=()=>{r.value=!1,c((()=>{r.value=!0}))};return u((()=>{a.activeIndex===a.matchIndex?h():r.value=!1})),(a,s)=>{const o=v("SportsIcon");return d(),m("div",{class:"match-item-wrap",style:S({backgroundImage:`url(${I(l)})`})},[r.value?(d(),_(I(P),{key:0,"live-url":e.liveInfo.m3u8||e.liveInfo.url,controls:!1,onRefresh:h},null,8,["live-url"])):f("",!0),p("div",X,[b(o,{class:"SportsIcon","icon-src":e.liveInfo.gameType},null,8,["icon-src"]),p("div",Z,g(e.liveInfo.leagueShortName||e.liveInfo.leagueName),1),A,p("div",{class:"time",innerHTML:I(t).showRBTime(e.liveInfo)},null,8,G)])],4)}}});J.__scopeId="data-v-6091e662";const Q={key:0,class:"swipeLive"},ee={class:"wrap"};var ae=l({setup(e){const a=i(0),t=i([]),s=e=>{a.value=e};return u((()=>{t.value.length=0,(async()=>{const e=await $({page:1,pageSize:5,rbType:1});if(200===e.code){const a=e?.data?.list||[];t.value.length=0,await a.map((async e=>{const a={gidm:e.gidm},s=await H(a);if(200===s.code){const{streamNa:a}=s.data,t=B(a);e.m3u8=e.m3u8||t,e.streamNa=a}t.value.push(e)}))}})()})),(e,l)=>{const o=v("van-swipe-item"),i=v("van-swipe");return t.value.length?(d(),m("div",Q,[b(i,{class:"my-swipe","indicator-color":"white",onChange:s},{default:j((()=>[(d(!0),m(U,null,N(t.value,((e,t)=>(d(),_(o,{key:t,onClick:a=>(e=>{if(!e)return;const{gidm:a}=e,t={name:"MatchDetail",params:{id:a}};L.push(t),M.dispatch("app/setMatchLiveIndex",1)})(e)},{default:j((()=>[p("div",ee,[(d(),_(J,{key:t,"live-info":e,"match-index":t,"active-index":a.value},null,8,["live-info","match-index","active-index"]))])])),_:2},1032,["onClick"])))),128))])),_:1})])):f("",!0)}}});ae.__scopeId="data-v-056cf7ce";const te={class:"tabs-cut"},se={class:"sportlive"};var le=l({setup(s){const l=o((()=>{const e=M.state.app.globalBarHeaderHeight||48;return e>60?48:e})),c=i(),h=i(!1),y=i(null),x=async(e=!0)=>{await B(),await $(e)},w=i(""),T=i(!0),S=i([""]),V=i([]),B=async()=>{const e=await D({})||{};if(200===e.code&&e.data){const a=e.data||[];V.value=a.filter((e=>!S.value.includes(e.gameType))),V.value=[{gameType:""},...V.value]}},L=i([]),$=async(e=!0)=>{const a={gameType:c.value||"",showtype:"RB",timeStage:0,dateStage:0,gameSort:1,isNovice:"Y",onlyFavorite:0,leagueIds:"",gameTypeSon:"",page:1,pageSize:200};e&&(h.value=!1);const t=await O(a)||{};if(e&&(h.value=!0),200===t.code&&t.data?.matchList?.baseData){const e=t.data?.matchList?.baseData||[];L.value=e.filter((e=>!S.value.includes(e.gameType)))}else L.value=[]},H=()=>{},F=e=>{L.value=[],c.value=e,$()};u((()=>{E(),h.value=!1,x()})),C((()=>{E()})),R((()=>{X()})),r((()=>{X(),M.dispatch("home/setKeyValue",{key:"RrefShow",value:!0}),M.dispatch("home/setKeyValue",{key:"OUrefShow",value:!0}),M.dispatch("home/setKeyValue",{key:"MrefShow",value:!0})}));const W=o((()=>M.state.app.businessConfig.pushSwitch));n(W,(()=>{E()}));const q=o((()=>M.state.user.scrollNumY));n((()=>q.value),(e=>{e>88&&(T.value=!1)}));const z=i(),E=()=>{clearTimeout(z),z.value=setTimeout((()=>{Y()}),100)},K=i(15e3),Y=()=>{1==+W.value&&(K.value=12e4),X(),P.value=setInterval((()=>{x(!1)}),K.value)},P=i(),X=()=>{clearInterval(P.value)},Z=i(""),A=o((()=>M.state.home.refreshChangeTime));return n(A,(e=>{e&&(clearTimeout(Z.value),Z.value=setTimeout((()=>{}),100))})),(s,o)=>{const i=v("SportsButton"),n=v("Loading"),u=v("van-sticky"),r=v("HomeEmpty"),x=v("FooterHeight"),S=v("van-tab"),C=v("van-tabs");return d(),m("div",{ref_key:"newContainer",ref:y},[b(ae,{class:"mt10"}),p("div",te,[b(C,{duration:.2,active:w.value,"onUpdate:active":o[0]||(o[0]=e=>w.value=e),shrink:"","line-height":"0",animated:T.value,onChange:F,"swipe-threshold":3,onClickTab:o[1]||(o[1]=e=>T.value=!0)},{default:j((()=>[(d(!0),m(U,null,N(V.value,((o,v)=>(d(),_(S,{key:v,name:o.gameType},{title:j((()=>[0===v?(d(),_(e,{key:0,text:s.$t("sport.all"),active:!c.value,class:"tabs-cut-1"},null,8,["text","active"])):(d(),_(i,{key:1,class:k(["tabs-cut-1",o.gameType]),text:o.gameType,active:w.value===o.gameType,count:o.count,"show-count":""},null,8,["text","active","class","count"]))])),default:j((()=>[p("div",se,[h.value?(d(),m(U,{key:1},[(d(!0),m(U,null,N(L.value,((e,s)=>(d(),m(U,{key:s},[0===s?(d(),_(u,{key:0,"offset-top":I(l),container:y.value,"z-index":"5"},{default:j((()=>[b(t,{class:k({mt20:0!==s}),"send-params":e},null,8,["class","send-params"])])),_:2},1032,["offset-top","container"])):f("",!0),b(a,{"play-title-toggle":!1,"send-params":e,tabType:"RB",class:k({mt10:0!==s})},null,8,["send-params","class"])],64)))),128)),L.value.length?f("",!0):(d(),_(r,{key:0}))],64)):(d(),_(n,{key:0})),L.value.length?(d(),m("div",{key:2,class:"Button-MatchMore mt10",onClick:H},[p("span",null,g(s.$t("live.noMore")),1)])):f("",!0),b(x)])])),_:2},1032,["name"])))),128))])),_:1},8,["duration","active","animated"])])],512)}}});le.__scopeId="data-v-68904684";export{le as default};
