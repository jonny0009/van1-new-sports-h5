import{_ as e}from"./index.55bf4e78.js";import a from"./index.d4e5a12e.js";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang.cc692eb9.js";import{u as l}from"./useMatch.c063f7e8.js";import{s,b as o,d as i,w as n,M as u,n as c,f as v,r,o as d,R as m,P as p,W as f,$ as h,q as y,_ as g,V as I,Y as b,Z as k,c as T,u as x,X as _,a as w,h as S,g as j,O as R,F as C,S as N}from"./vue.5fe62a63.js";import{v as V}from"./video.es.55c63f2c.js";import{s as M,R as U,T as B}from"./index.7c141abc.js";import{e as L,a as $}from"./index.4f6b1f1d.js";import"./getScore.a9f048ac.js";const H={class:"video-box-wrap"},D={key:0,class:"video-error"},O=(e=>(b("data-v-0bcb1388"),e=e(),k(),e))((()=>p("span",{class:"video-icon"},null,-1))),F={class:"error-tips"},q=["onClick"];var z=s({props:{liveUrl:{type:String,default:""},controls:{type:Boolean,default:!0}},emits:["refresh","touchVideo"],setup(e,{expose:a,emit:t}){const l=e,s=o((()=>M.state.match.turnSound)),b=i(null),k=i(!1),T=i(!0);n(s,((e,a)=>{console.log(`turnSound发生变化，新值为：${e}，旧值为：${a}`),e?(b.value.muted(!1),T.value=!1):(b.value.muted(!0),T.value=!0)}));const x=()=>{s.value?(T.value=!1,b.value.muted(!1)):(T.value=!0,b.value.muted(!0))},_=i(),w=()=>{try{b.value.dispose&&b.value.dispose()}catch(e){}},S=()=>{if(!document.querySelector("#VideoRef"))return!1;b.value.muted()?(b.value.muted(!1),T.value=!1,M.commit("match/SET_TURN_SOUND",!1)):(b.value.muted(!0),T.value=!0,M.commit("match/SET_TURN_SOUND",!0))},j=()=>{t("refresh")};a({refresh:j,touchVideo:()=>{t("touchVideo")}});const R=i(!0);return u((()=>{c((()=>{clearTimeout(_.value),_.value=setTimeout((()=>{k.value=!1;const e=document.querySelector("#VideoRef");if(e&&l.liveUrl)try{b.value=V("VideoRef",{muted:!0,controls:l.controls,width:"100%",height:"100%",loop:!0,autoplay:!0,sources:[{src:l.liveUrl,type:"application/x-mpegURL"}]},(()=>{try{e.muted=!0,e.play(),b.value.on("error",(()=>{k.value=!0,w()}))}catch(a){console.error(a)}}))}catch(a){console.error("视频异常！"),console.error(a)}}),500),setTimeout((()=>{R.value=!1}),2e3)}))})),v((()=>{w()})),(e,a)=>{const t=r("van-loading");return d(),m("div",H,[p("video",{id:"VideoRef",style:{"object-fit":"fill"},class:"video-js vjs-default-skin",playsinline:"true",controls:"",preload:"metadata",onPlay:x},null,32),k.value?(d(),m("div",D,[O,p("div",F,f(e.$t("live.videoFailure")),1),p("div",{class:"error-btn",onClick:j},f(e.$t("live.refreshVideo")),1)])):h("",!0),p("div",{class:g(["pop",{popBg:R.value}])},[y(t,{class:"popBg-loading"})],2),p("div",{class:g(["sound-icon",{muted:T.value}]),onClick:I(S,["stop"])},null,10,q)])}}});z.__scopeId="data-v-0bcb1388";const E={class:"video-footer"},K={class:"leagueName text-overflow"},Y=(e=>(b("data-v-35f5d5c8"),e=e(),k(),e))((()=>p("div",{class:"flex-1"},null,-1))),P=["innerHTML"];var W=s({props:{liveInfo:{type:Object,default:()=>{}},matchIndex:{type:Number,default:0},activeIndex:{type:Number,default:0}},setup(e){const a=e,t=l(),s=o((()=>"/assets/ft.7964dceb.jpg"));n((()=>a.activeIndex),(()=>{a.activeIndex===a.matchIndex?b():I.value=!1})),n((()=>a.liveInfo.gidm),(()=>{g()})),u((()=>{g()}));const v=i(""),g=async()=>{const e=a.liveInfo.gidm,t=await L({gidm:e});if(200===t.code){const{streamNa:e}=t.data,{liveali:l,live:s}=e||{},{m3u8:o}=l||s||{};v.value=a.liveInfo.m3u8||o}},I=i(!1),b=()=>{I.value=!1,c((()=>{I.value=!0}))};return u((()=>{a.activeIndex===a.matchIndex?b():I.value=!1})),(a,l)=>{const o=r("SportsIcon");return d(),m("div",{class:"match-item-wrap",style:_({backgroundImage:`url(${x(s)})`})},[I.value?(d(),T(x(z),{key:0,"live-url":v.value||e.liveInfo.url,liveInfo:e.liveInfo,controls:!1,onRefresh:b},null,8,["live-url","liveInfo"])):h("",!0),p("div",E,[y(o,{class:"SportsIcon","icon-src":e.liveInfo.gameType},null,8,["icon-src"]),p("div",K,f(e.liveInfo.leagueShortName||e.liveInfo.leagueName),1),Y,p("div",{class:"time",innerHTML:x(t).showRBTime(e.liveInfo)},null,8,P)])],4)}}});W.__scopeId="data-v-35f5d5c8";const X={key:0,class:"swipeLive"},Z={class:"wrap"};var A=s({setup(e){const a=i(0),t=i([]),l=async()=>{var e;const a=await $({page:1,pageSize:5,rbType:1});if(200===a.code){const l=(null==(e=null==a?void 0:a.data)?void 0:e.list)||[];t.value=l}},s=e=>{a.value=e},o=i();return w((()=>{clearInterval(o.value)})),S((()=>{clearInterval(o.value)})),j((()=>{clearInterval(o.value),console.log(1234),o.value=setInterval((()=>{l()}),15e3)})),u((()=>{t.value.length=0,l(),o.value=setInterval((()=>{l()}),1e4)})),(e,l)=>{const o=r("van-swipe-item"),i=r("van-swipe");return t.value.length?(d(),m("div",X,[y(i,{class:"my-swipe","indicator-color":"white",onChange:s},{default:R((()=>[(d(!0),m(C,null,N(t.value,((e,t)=>(d(),T(o,{key:t,onClick:a=>(e=>{if(!e)return;const{gidm:a}=e,t={name:"MatchDetail",params:{id:a}};router.push(t),store.dispatch("app/setMatchLiveIndex",1)})(e)},{default:R((()=>[p("div",Z,[(d(),T(W,{key:e.gidm,"live-info":e,"match-index":t,"active-index":a.value},null,8,["live-info","match-index","active-index"]))])])),_:2},1032,["onClick"])))),128))])),_:1})])):h("",!0)}}});A.__scopeId="data-v-d396885c";const G={class:"tabs-cut"},J={class:"sportlive"};var Q=s({setup(l){const s=o((()=>{const e=M.state.app.globalBarHeaderHeight||48;return e>60?48:e})),c=i(),I=i(!1),b=i(null),k=async(e=!0)=>{await $(),await D(e)},_=i(""),w=i(!0),V=i([""]),L=i([]),$=async()=>{const e=await U({})||{};if(200===e.code&&e.data){const a=e.data||[];L.value=a.filter((e=>!V.value.includes(e.gameType))),L.value=[{gameType:""},...L.value]}},H=i([]),D=async(e=!0)=>{var a,t,l,s;const o={gameType:c.value||"",showtype:"RB",timeStage:0,dateStage:0,gameSort:1,isNovice:"Y",onlyFavorite:0,leagueIds:"",gameTypeSon:"",page:1,pageSize:200};e&&(I.value=!1);const i=await B(o)||{};if(e&&(I.value=!0),200===i.code&&(null==(t=null==(a=i.data)?void 0:a.matchList)?void 0:t.baseData)){const e=(null==(s=null==(l=i.data)?void 0:l.matchList)?void 0:s.baseData)||[];H.value=e.filter((e=>!V.value.includes(e.gameType)))}else H.value=[]},O=()=>{},F=e=>{H.value=[],c.value=e,D()};u((()=>{K(),I.value=!1,k()})),j((()=>{K()})),S((()=>{X()})),v((()=>{X(),M.dispatch("home/setKeyValue",{key:"RrefShow",value:!0}),M.dispatch("home/setKeyValue",{key:"OUrefShow",value:!0}),M.dispatch("home/setKeyValue",{key:"MrefShow",value:!0})}));const q=o((()=>M.state.app.businessConfig.pushSwitch));n(q,(()=>{K()}));const z=o((()=>M.state.user.scrollNumY));n((()=>z.value),(e=>{e>88&&(w.value=!1)}));const E=i(),K=()=>{clearTimeout(E),E.value=setTimeout((()=>{P()}),100)},Y=i(15e3),P=()=>{1==+q.value&&(Y.value=12e4),X(),W.value=setInterval((()=>{k(!1)}),Y.value)},W=i(),X=()=>{clearInterval(W.value)},Z=i(""),Q=o((()=>M.state.home.refreshChangeTime));return n(Q,(e=>{e&&(clearTimeout(Z.value),Z.value=setTimeout((()=>{}),100))})),(l,o)=>{const i=r("SportsButton"),n=r("Loading"),u=r("van-sticky"),v=r("HomeEmpty"),k=r("FooterHeight"),S=r("van-tab"),j=r("van-tabs");return d(),m("div",{ref_key:"newContainer",ref:b},[y(A,{class:"mt10"}),p("div",G,[y(j,{duration:.2,active:_.value,"onUpdate:active":o[0]||(o[0]=e=>_.value=e),shrink:"","line-height":"0",animated:w.value,onChange:F,"swipe-threshold":3,onClickTab:o[1]||(o[1]=e=>w.value=!0)},{default:R((()=>[(d(!0),m(C,null,N(L.value,((o,r)=>(d(),T(S,{key:r,name:o.gameType},{title:R((()=>[0===r?(d(),T(e,{key:0,text:l.$t("sport.all"),active:!c.value,class:"tabs-cut-1"},null,8,["text","active"])):(d(),T(i,{key:1,class:g(["tabs-cut-1",o.gameType]),text:o.gameType,active:_.value===o.gameType,count:o.count,"show-count":""},null,8,["text","active","class","count"]))])),default:R((()=>[p("div",J,[I.value?(d(),m(C,{key:1},[(d(!0),m(C,null,N(H.value,((e,l)=>(d(),m(C,{key:l},[0===l?(d(),T(u,{key:0,"offset-top":x(s),container:b.value,"z-index":"5"},{default:R((()=>[y(t,{class:g({mt20:0!==l}),"send-params":e},null,8,["class","send-params"])])),_:2},1032,["offset-top","container"])):h("",!0),y(a,{"play-title-toggle":!1,"send-params":e,tabType:"RB",class:g({mt10:0!==l})},null,8,["send-params","class"])],64)))),128)),H.value.length?h("",!0):(d(),T(v,{key:0}))],64)):(d(),T(n,{key:0})),H.value.length?(d(),m("div",{key:2,class:"Button-MatchMore mt10",onClick:O},[p("span",null,f(l.$t("live.noMore")),1)])):h("",!0),y(k)])])),_:2},1032,["name"])))),128))])),_:1},8,["duration","active","animated"])])],512)}}});Q.__scopeId="data-v-68904684";export{Q as default};
